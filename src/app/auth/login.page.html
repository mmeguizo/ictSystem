<main class="login-container">
  <section class="card" role="region" aria-labelledby="login-title">
    <h1 id="login-title">Sign in</h1>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
      <div class="form-item">
        <label for="email" class="label">Email</label>
        <div class="control">
          <input
            id="email"
            type="email"
            autocomplete="username"
            formControlName="email"
            [attr.aria-invalid]="emailInvalid"
            [attr.aria-describedby]="emailInvalid ? 'email-error' : null"
          />
          @if (emailInvalid) {
            <div id="email-error" class="error">
              @if (form.controls.email.hasError('required')) { Please enter your email. }
              @if (form.controls.email.hasError('email')) { Please enter a valid email address. }
              @if (form.controls.email.hasError('chmsuDomain')) { Email must be a @chmsu.edu.ph address. }
            </div>
          }
        </div>
      </div>

      <div class="form-item">
        <label for="password" class="label">Password</label>
        <div class="control">
          <input
            id="password"
            type="password"
            autocomplete="current-password"
            formControlName="password"
            [attr.aria-invalid]="passwordInvalid"
            [attr.aria-describedby]="passwordInvalid ? 'password-error' : null"
          />
          @if (passwordInvalid) {
            <div id="password-error" class="error">Password is required (min 6 chars).</div>
          }
        </div>
      </div>

      @if (error()) {
        <div class="error" role="alert">{{ error() }}</div>
      }

      <button type="submit" class="primary" [disabled]="submitDisabled">{{ busy() ? 'Signing inâ€¦' : 'Sign in' }}</button>
    </form>

    @if (loggedIn()) {
      <p class="success" role="status">Logged in (demo). You can now navigate.</p>
    }
  </section>
</main>
